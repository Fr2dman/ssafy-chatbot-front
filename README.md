# MediMind - AI 복약 및 마음 상담 시스템

## 🏗️ 시스템 아키텍처

### 전체 시스템 구성도
```
┌─────────────────────────────────────────────────────────────────┐
│                        Frontend (Vercel)                        │
├─────────────────────────────────────────────────────────────────┤
│  • HTML/CSS/JavaScript (Vanilla JS)                             │
│  • Tailwind CSS                                                 │
│  • Parcel (빌드 도구)                                            │
│  • IndexedDB (로컬 저장소)                                        │
└─────────────────────────┬───────────────────────────────────────┘
                          │ HTTP/REST API
                          │
┌─────────────────────────▼───────────────────────────────────────┐
│                      Backend (Fly.io)                           │
├─────────────────────────────────────────────────────────────────┤
│  • FastAPI (Python)                                             │
│  • CORS 미들웨어                                                 │
│  • 2개 엔드포인트: /chat, /assistant                              │
└─────────────────────────┬───────────────────────────────────────┘
                          │
        ┌─────────────────┴─────────────────┐
        │                                   │
        ▼                                   ▼
┌──────────────────┐              ┌──────────────────┐
│   마음 상담 모드   │              │   복약 상담 모드   │
│                  │              │                  │
│  OpenAI API      │              │  RAG Pipeline    │
│  GPT-4o-mini     │              │                  │
└──────────────────┘              └─────────┬────────┘
                                           │
                          ┌────────────────┼────────────────┐
                          │                │                │
                          ▼                ▼                ▼
                   ┌──────────────┐ ┌──────────────┐ ┌──────────────┐
                   │   Upstage    │ │   Pinecone   │ │   LangChain  │
                   │              │ │              │ │              │
                   │ • LLM        │ │ • Vector DB  │ │ • RAG Chain  │
                   │ • Embeddings │ │ • 의약품 지식  │ │ • Retrieval  │
                   └──────────────┘ └──────────────┘ └──────────────┘
```

### 데이터 흐름

#### 1. 복약 상담 모드
```
사용자 입력 → 프로필 정보 결합 → 약물 태그 추가 → /assistant API 
→ RAG 파이프라인 → Pinecone 벡터 검색 → Upstage LLM → 전문적 답변
```

#### 2. 마음 상담 모드
```
사용자 입력 → 프로필 정보 결합 → /chat API 
→ OpenAI GPT-4o-mini → 감정적 지원 답변
```

## 🛠️ 기술 스택

### Frontend
| 카테고리 | 기술 | 용도 |
|---------|------|-----|
| **언어** | HTML5, CSS3, JavaScript (ES6+) | 기본 웹 기술 |
| **스타일링** | Tailwind CSS | 유틸리티 우선 CSS 프레임워크 |
| **빌드 도구** | Parcel | 모듈 번들러 및 개발 서버 |
| **상태 관리** | Vanilla JS | 네이티브 JavaScript 상태 관리 |
| **로컬 저장소** | IndexedDB | 브라우저 내 구조화된 데이터 저장 |
| **배포** | Vercel | 정적 사이트 호스팅 |

### Backend
| 카테고리 | 기술 | 용도 |
|---------|------|-----|
| **언어** | Python 3.x | 서버 사이드 개발 |
| **웹 프레임워크** | FastAPI | 고성능 비동기 웹 API 프레임워크 |
| **배포** | Fly.io | 컨테이너 기반 클라우드 플랫폼 |
| **환경 관리** | python-dotenv | 환경 변수 관리 |

### AI/ML & RAG Pipeline
| 카테고리 | 기술 | 용도 |
|---------|------|-----|
| **LLM (마음상담)** | OpenAI GPT-4o-mini | 감정적 지원 및 일반 대화 |
| **LLM (복약상담)** | Upstage ChatUpstage | 전문적 의약품 상담 |
| **임베딩** | Upstage Embeddings | 텍스트 벡터화 |
| **벡터 DB** | Pinecone | 고성능 벡터 검색 엔진 |
| **RAG 프레임워크** | LangChain | 검색 증강 생성 파이프라인 |
| **데이터 처리** | pandas | 데이터 전처리 및 조작 |

### 데이터베이스 & 저장소
| 카테고리 | 기술 | 용도 |
|---------|------|-----|
| **클라이언트 DB** | IndexedDB | 채팅 기록 및 사용자 프로필 |
| **벡터 DB** | Pinecone | 의약품 지식 벡터 저장 |
| **지식 베이스** | CSV 파일 | 의약품 안전성 문서 |

### 개발 도구
| 카테고리 | 기술 | 용도 |
|---------|------|-----|
| **패키지 관리** | npm (Frontend), pip (Backend) | 의존성 관리 |
| **개발 서버** | Parcel Dev Server, Uvicorn | 로컬 개발 환경 |
| **버전 관리** | Git | 소스 코드 관리 |

## 🏛️ 아키텍처 특징

### 1. 마이크로서비스 아키텍처
- **프론트엔드**: 정적 사이트 (Vercel)
- **백엔드**: API 서버 (Fly.io)
- **AI 서비스**: 외부 AI 플랫폼 (OpenAI, Upstage)
- **데이터**: 벡터 DB (Pinecone)

### 2. 하이브리드 AI 접근법
- **전문성**: RAG 파이프라인으로 의약품 전문 지식 활용
- **감정 지원**: GPT-4o-mini로 자연스러운 대화 지원
- **모드 분리**: 용도에 따른 최적화된 AI 모델 선택

### 3. 확장 가능한 설계
- **모듈식 구조**: 각 컴포넌트 독립적 확장 가능
- **API 중심**: RESTful API로 플랫폼 확장 용이
- **클라우드 네이티브**: 서버리스 및 관리형 서비스 활용

### 4. 사용자 경험 최적화
- **반응형 UI**: 모바일/데스크톱 대응
- **실시간 상호작용**: 즉시 응답 및 로딩 상태 표시
- **로컬 저장**: 오프라인 대화 기록 유지
- **테마 전환**: 복약상담 ↔ 마음상담 원클릭 전환

## 🔧 핵심 기능

### RAG 파이프라인 상세
```python
# 검색 설정
search_type='mmr'  # Maximum Marginal Relevance
search_kwargs={"k": 3}  # 상위 3개 문서 검색

# 문서 분할 설정
chunk_size=1000  # 1000자 청크
chunk_overlap=100  # 100자 오버랩

# 벡터 인덱스
dimension=4096  # Upstage 임베딩 차원
metric="cosine"  # 코사인 유사도
```

### 데이터 보안
- **환경 변수**: API 키 및 민감 정보 보호
- **CORS**: 프론트엔드 도메인 허용
- **클라이언트 사이드**: 개인정보 로컬 저장

이 아키텍처는 의료 분야의 전문성과 감정적 지원을 동시에 제공하면서도, 확장 가능하고 유지보수가 용이한 웹 애플리케이션 구조를 구현하고 있습니다.